<div class="container">
  <div fxLayout="column">
    <div class="custom-flex-filters" #filters>
      <!-- study level -->
      <mat-form-field>
        <mat-label>{{ "filters.study_level" | translate }}</mat-label>
        <mat-select [(ngModel)]="studyLevel">
          <mat-option *ngFor="let category of categories" [value]="category">
            {{ category }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <!-- keywords search -->
      <mat-form-field>
        <input
          matInput
          placeholder="{{ 'filters.keywords.name' | translate }}"
          [formControl]="keywordsSearch"
        />
      </mat-form-field>
      <!-- description search -->
      <mat-form-field>
        <input
          matInput
          placeholder="{{ 'filters.keywords.description' | translate }}"
          [formControl]="descriptionSearch"
        />
      </mat-form-field>
      <!-- locatin search -->
      <mat-form-field>
        <mat-label>{{
          "filters.keywords.location.label" | translate
        }}</mat-label>
        <mat-select [formControl]="locations">
          <mat-select-trigger>
            {{
              locations.value
                ? locations.value === "all_locations"
                  ? ("filters.keywords.location.all_locations" | translate)
                  : locations.value
                : ""
            }}
          </mat-select-trigger>
          <mat-option value="all_locations">{{
            "filters.keywords.location.all_locations" | translate
          }}</mat-option>
          <mat-option
            *ngFor="let location of locationsList"
            [value]="location"
            >{{ location }}</mat-option
          >
        </mat-select>
      </mat-form-field>
      <!-- facilities search -->
      <mat-form-field *ngIf="studyLevel === 'University'">
        <mat-label>{{
          "filters.keywords.facilities.label" | translate
        }}</mat-label>
        <mat-select [formControl]="facilities" multiple>
          <mat-select-trigger>
            {{ facilities.value ? (facilities.value[0] | translate) : "" }}
            <span
              *ngIf="facilities.value?.length > 1"
              class="example-additional-selection"
            >
              (+{{ facilities.value.length - 1 }}
              {{ facilities.value?.length === 2 ? "other" : "others" }})
            </span>
          </mat-select-trigger>
          <mat-option
            *ngFor="let facility of facilitiesList"
            [value]="facility"
          >
            {{ facility | instantFacilityTranslate }}</mat-option
          >
        </mat-select>
      </mat-form-field>
      <!-- rating -->
      <mat-form-field>
        <mat-label>{{ "filters.sort_rating" | translate }}</mat-label>
        <mat-select [(ngModel)]="ratingType">
          <mat-option *ngFor="let sort of sortTypes" [value]="sort">
            {{ sort }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <!-- type -->
      <mat-form-field *ngIf="studyLevel === 'University'">
        <mat-label>{{
          "filters.institution_type.label" | translate
        }}</mat-label>
        <mat-select multiple [(ngModel)]="institutionTypeSelection">
          <mat-option value="stat">{{
            "filters.institution_type.state" | translate
          }}</mat-option>
          <mat-option value="privat">{{
            "filters.institution_type.private" | translate
          }}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div #results id="resultsId">
      <div class="grey-text" style="padding: 20px;">
        {{ getData().length }} {{ "filters.result_counter" | translate }}
      </div>
      <div class="results-cards">
        <div *ngFor="let result of getData()">
          <!-- university results -->
          <mat-card
            class="custom-card"
            *ngIf="studyLevel === 'University'"
          >
            <img
              mat-card-image
              src="{{ result.logoUniversity }}"
              *ngIf="result.logoUniversity"
            />
            <img
              mat-card-image
              src="assets/university.png"
              *ngIf="!result.logoUniversity"
            />
            <mat-card-content>
              <p class="dark-blue-bold-text">
                {{ result.nameUniversity | uppercase }}
              </p>
              <p class="grey-text" *ngIf="result.locality">
                {{ result.locality }}
              </p>
              <app-editable-star-rating
                *ngIf="result.universityId"
                [id]="result.universityId"
                [editable]="false"
                type="university"
                showNumberOfRatings="true"
              >
              </app-editable-star-rating>
            </mat-card-content>
            <mat-card-content>
              <app-wave-button
                text="{{ 'buttons.more_details' | translate | uppercase }}"
                (click)="goToUniversity(result.universityId)"
              ></app-wave-button>
            </mat-card-content>
          </mat-card>
          <!-- faculty results -->
          <mat-card
            class="custom-card"
            fxLayout="column"
            fxLayoutAlign="center center"
            *ngIf="studyLevel === 'Faculty'"
          >
            <img
              mat-card-image
              src="{{ result.logoFaculty }}"
              *ngIf="result.logoFaculty"
            />
            <img
              mat-card-image
              src="assets/university.png"
              *ngIf="!result.logoFaculty"
            />
            <mat-card-content>
              <p class="dark-blue-bold-text">
                {{ result.nameFaculty | uppercase }}
              </p>
              <p class="grey-text" *ngIf="result.locationFaculty">
                {{ result.locationFaculty | location }}
              </p>
              <app-editable-star-rating
                *ngIf="result.facultyId"
                [id]="result.facultyId"
                [editable]="false"
                type="faculty"
                showNumberOfRatings="true"
              >
              </app-editable-star-rating>
            </mat-card-content>
            <mat-card-content>
              <app-wave-button
                text="{{ 'buttons.more_details' | translate | uppercase }}"
                (click)="goToUniversity(result.facultyId)"
              ></app-wave-button>
            </mat-card-content>
          </mat-card>
          <!-- bachelor results -->
          <mat-card
            class="custom-card"
            fxLayout="column"
            fxLayoutAlign="center center"
            *ngIf="studyLevel === 'Bachelor'"
          >
            <img
              mat-card-image
              src="{{ result.logoFaculty }}"
              *ngIf="result.logoFaculty"
            />
            <img
              mat-card-image
              src="assets/university.png"
              *ngIf="!result.logoFaculty"
            />
            <mat-card-content>
              <p class="dark-blue-bold-text">{{ result.name | uppercase }}</p>
              <p class="grey-text" *ngIf="result.locationFaculty">
                {{ result.locationFaculty | location }}
              </p>
              <!-- TODO those ratings -->
              <!-- <app-editable-star-rating *ngIf="result.facultyId" [id]="result.facultyId" [editable]="false" type="faculty" showNumberOfRatings="true">
              </app-editable-star-rating> -->
            </mat-card-content>
            <mat-card-content>
              <app-wave-button
                text="{{ 'buttons.more_details' | translate | uppercase }}"
                (click)="goToUniversity(result.facultyId)"
              ></app-wave-button>
            </mat-card-content>
            <!-- TODO verify why this buttons are not working -->
          </mat-card>
          <!-- masters results -->
          <mat-card
            class="custom-card"
            fxLayout="column"
            fxLayoutAlign="center center"
            *ngIf="studyLevel === 'Master'"
          >
            <img
              mat-card-image
              src="{{ result.logoFaculty }}"
              *ngIf="result.logoFaculty"
            />
            <img
              mat-card-image
              src="assets/university.png"
              *ngIf="!result.logoFaculty"
            />
            <mat-card-content>
              <p class="dark-blue-bold-text">{{ result.name | uppercase }}</p>
              <p class="grey-text" *ngIf="result.locationFaculty">
                {{ result.locationFaculty | location }}
              </p>
              <!-- <app-editable-star-rating *ngIf="result.facultyId" [id]="result.facultyId" [editable]="false" type="faculty" showNumberOfRatings="true">
              </app-editable-star-rating> -->
            </mat-card-content>
            <mat-card-content>
              <app-wave-button
                text="{{ 'buttons.more_details' | translate | uppercase }}"
                (click)="goToUniversity(result.facultyId)"
              ></app-wave-button>
            </mat-card-content>
          </mat-card>
          <!-- doctorals results -->
          <mat-card
            class="custom-card"
            fxLayout="column"
            fxLayoutAlign="center center"
            *ngIf="studyLevel === 'Doctoral'"
          >
            <img
              mat-card-image
              src="{{ result.logoFaculty }}"
              *ngIf="result.logoFaculty"
            />
            <img
              mat-card-image
              src="assets/university.png"
              *ngIf="!result.logoFaculty"
            />
            <mat-card-content>
              <p class="dark-blue-bold-text">{{ result.name | uppercase }}</p>
              <p class="grey-text" *ngIf="result.locationFaculty">
                {{ result.locationFaculty | location }}
              </p>
              <!-- <p *ngIf="result.semesters">
                {{ result.semesters }} {{ 'filters.counter_semesters' | translate }}
              </p>
              <p *ngIf="result.years">
                {{ result.years }} {{ 'filters.counter_years' | translate }}
              </p> -->
            </mat-card-content>
            <mat-card-content>
              <app-wave-button
                text="{{ 'buttons.more_details' | translate | uppercase }}"
                (click)="goToUniversity(result.facultyId)"
              ></app-wave-button>
            </mat-card-content>
          </mat-card>
        </div>
      </div>
    </div>
  </div>
</div>
